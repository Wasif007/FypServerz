(function(){angular.module("pingFyp",["ngRoute","ngSanitize","ui.bootstrap"]);function r(r,e){r.when("/signup",{templateUrl:"/auth/register/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/supervisor",{templateUrl:"/supervisor/supervisor.view.html",controller:"supervisorCtrl",controllerAs:"vm"}).when("/modules",{templateUrl:"/modules/modules.view.html",controllerAs:"vm",controller:"modulesCtrl"}).when("/addguard",{templateUrl:"/addguard/addguard.view.html",controller:"addguardCtrl",controllerAs:"vm"}).when("/history",{templateUrl:"/history/history.view.html",controller:"historyCtrl",controllerAs:"vm"}).when("/assign",{templateUrl:"/assign/assign.view.html",controller:"assignCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/login"});e.html5Mode(true)}function e(r,e,n){r.$on("$routeChangeStart",function(r,t,o){if(e.path()==="/profile"&&!n.isLoggedIn()){e.path("/")}})}angular.module("pingFyp").config(["$routeProvider","$locationProvider",r]).run(["$rootScope","$location","authentication",e])})();(function(){angular.module("pingFyp").controller("supervisorCtrl",r);function r(){var r=this}})();(function(){angular.module("pingFyp").controller("modulesCtrl",r);function r(){var r=this}})();(function(){angular.module("pingFyp").controller("assignCtrl",r);function r(){var r=this}})();(function(){angular.module("pingFyp").controller("historyCtrl",r);function r(){var r=this}})();(function(){angular.module("pingFyp").controller("addguardCtrl",r);function r(){var r=this}})();(function(){angular.module("pingFyp").controller("loginCtrl",r);r.$inject=["authentication","$location"];function r(r,e){var n=this;n.pageHeader={title:"Login in to PING"};n.credentials={email:"",password:""};n.onSubmit=function(){n.formError="";if(!n.credentials.email||!n.credentials.password){n.formError="All fields required, please try again";return false}else{n.doLogin()}};n.doLogin=function(){n.formError="";r.login(n.credentials).error(function(r){if(r.message="Incorrect Password"){n.formError="Password doesnot matches"}else{n.formError=r}}).then(function(){e.path("/supervisor")})}}})();(function(){angular.module("pingFyp").controller("registerCtrl",r);r.$inject=["authentication","$location"];function r(r,e){var n=this;n.pageHeader={title:"Create a new PING account"};n.credentials={name:"",email:"",password:""};n.onSubmit=function(){n.formError="";if(!n.credentials.name||!n.credentials.email||!n.credentials.password){n.formError="All fields required, please try again";return false}else{n.doRegister()}};n.doRegister=function(){n.formError="";r.register(n.credentials).error(function(r){if(r.name=="ValidationError"){n.formError="Email is already taken"}else{n.formError=r}}).then(function(){e.path("/login")})}}})();(function(){angular.module("pingFyp").service("authentication",r);r.$inject=["$http","$window"];function r(r,e){var n=function(r){e.localStorage["ping-token"]=r};var t=function(){return e.localStorage["ping-token"]};var o=function(){var r=t();if(r){var n=JSON.parse(e.atob(r.split(".")[1]));return n.exp>Date.now()/1e3}else{return false}};var i=function(){if(o()){var r=t();var n=JSON.parse(e.atob(r.split(".")[1]));return{email:n.email,name:n.name}}};register=function(e){return r.post("/api/signup",e).success(function(r){n(r.token)})};login=function(e){return r.post("/api/login",e).success(function(r){n(r.token)})};logout=function(){e.localStorage.removeItem("ping-token")};return{currentUser:i,saveToken:n,getToken:t,isLoggedIn:o,register:register,login:login,logout:logout}}})();(function(){angular.module("pingFyp").service("meanData",r);r.$inject=["$http","authentication"];function r(r,e){var n=function(){return r.get("/api/users",{headers:{Authorization:"Bearer "+e.getToken()}})};return{getProfile:n}}})();