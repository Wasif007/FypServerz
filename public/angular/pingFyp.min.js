(function(){angular.module("pingFyp",["ngRoute","ngSanitize","ui.bootstrap"]);function e(e,r){e.when("/signup",{templateUrl:"/auth/register/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/supervisor",{templateUrl:"/supervisor/supervisor.view.html",controller:"supervisorCtrl",controllerAs:"vm"}).when("/modules",{templateUrl:"/modules/modules.view.html",controllerAs:"vm",controller:"modulesCtrl"}).when("/addguard",{templateUrl:"/addguard/addguard.view.html",controller:"addguardCtrl",controllerAs:"vm"}).when("/history",{templateUrl:"/history/history.view.html",controller:"historyCtrl",controllerAs:"vm"}).when("/assign",{templateUrl:"/assign/assign.view.html",controller:"assignCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/login"});r.html5Mode(true)}function r(e,r,n){e.$on("$routeChangeStart",function(e,t,o){if(r.path()==="/profile"&&!n.isLoggedIn()){r.path("/")}})}angular.module("pingFyp").config(["$routeProvider","$locationProvider",e]).run(["$rootScope","$location","authentication",r])})();(function(){angular.module("pingFyp").controller("supervisorCtrl",e);function e(){var e=this}})();(function(){angular.module("pingFyp").controller("modulesCtrl",e);function e(){var e=this}})();(function(){angular.module("pingFyp").controller("assignCtrl",e);function e(){var e=this}})();(function(){angular.module("pingFyp").controller("historyCtrl",e);function e(){var e=this}})();(function(){angular.module("pingFyp").controller("addguardCtrl",e);function e(){var e=this}})();(function(){angular.module("pingFyp").controller("loginCtrl",e);e.$inject=["authentication","$location"];function e(e,r){var n=this;n.pageHeader={title:"Login in to PING"};n.credentials={email:"",password:""};n.onSubmit=function(){n.formError="";if(!n.credentials.email||!n.credentials.password){n.formError="All fields required, please try again";return false}else{n.doLogin()}};n.doLogin=function(){n.formError="";e.login(n.credentials).error(function(e){if(e.message="Incorrect Password"){n.formError="Password doesnot matches"}else{n.formError=e}}).then(function(){r.path("/supervisor")})}}})();(function(){angular.module("pingFyp").controller("registerCtrl",e);e.$inject=["authentication","$location"];function e(e,r){var n=this;n.pageHeader={title:"Create a new PING account"};n.credentials={name:"",email:"",password:"",file:"",phone:"",home_address:""};n.onSubmit=function(){n.formError="";if(!n.credentials.name||!n.credentials.home_address||!n.credentials.file||!n.credentials.phone||!n.credentials.email||!n.credentials.password){n.formError="All fields required, please try again"+n.credentials.file+" "+n.credentials.name+" "+n.credentials.email+" "+n.credentials.phone+" "+n.credentials.password+" "+n.credentials.home_address+" "+n.credentials.file+" "+photo.file;return false}else{n.doRegister()}};n.doRegister=function(){n.formError="";e.register(n.credentials).error(function(e){if(e.name=="ValidationError"){n.formError="Email is already taken"}else{n.formError=e}}).then(function(){r.path("/login")})}}})();(function(){angular.module("pingFyp").service("authentication",e);e.$inject=["$http","$window"];function e(e,r){var n=function(e){r.localStorage["ping-token"]=e};var t=function(){return r.localStorage["ping-token"]};var o=function(){var e=t();if(e){var n=JSON.parse(r.atob(e.split(".")[1]));return n.exp>Date.now()/1e3}else{return false}};var i=function(){if(o()){var e=t();var n=JSON.parse(r.atob(e.split(".")[1]));return{email:n.email,name:n.name}}};register=function(r){return e.post("/api/supervisorSignup",r).success(function(e){n(e.token)})};login=function(r){return e.post("/api/supervisorLogin",r).success(function(e){n(e.token)})};logout=function(){r.localStorage.removeItem("ping-token")};return{currentUser:i,saveToken:n,getToken:t,isLoggedIn:o,register:register,login:login,logout:logout}}})();(function(){angular.module("pingFyp").service("meanData",e);e.$inject=["$http","authentication"];function e(e,r){var n=function(){return e.get("/api/users",{headers:{Authorization:"Bearer "+r.getToken()}})};return{getProfile:n}}})();